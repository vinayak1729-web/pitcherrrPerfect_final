<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pitcher Perfect - MLB Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Baseball+Script&display=swap" rel="stylesheet">
    <style>
        :root {
            --neon-red: #ff1744;
            --neon-blue: #2979ff;
        }

        .baseball-font {
            font-family: 'Baseball Script', cursive;
        }

        .neon-text {
            text-shadow: 0 0 10px currentColor;
        }

        .neon-box {
            box-shadow: 0 0 15px currentColor;
        }

        .dark body {
            background-color: #0a0a0a;
            color: #fff;
        }

        .dark .bg-white {
            background-color: #1a1a1a;
            color: #fff;
        }

        .dark .news-card {
            background-color: #1a1a1a;
            border: 1px solid #333;
        }

        .dark .text-gray-800 {
            color: #fff;
        }

        .dark .text-gray-600 {
            color: #cbd5e0;
        }

        .news-scroll {
            max-height: calc(100vh - 200px);
            scrollbar-width: thin;
            scrollbar-color: var(--neon-red) #1a1a1a;
        }

        .news-scroll::-webkit-scrollbar {
            width: 6px;
        }

        .news-scroll::-webkit-scrollbar-track {
            background: #1a1a1a;
        }

        .news-scroll::-webkit-scrollbar-thumb {
            background-color: var(--neon-red);
            border-radius: 3px;
        }

        @keyframes neonPulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.8;
            }
        }

        .neon-pulse {
            animation: neonPulse 2s infinite;
        }
    </style>
</head>

<body class="bg-gray-100 light:bg-gray-900 min-h-screen transition-colors duration-300">
    <!-- Navbar -->
    <nav class="bg-white dark:bg-gray-800 shadow-lg">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <div class="baseball-font text-3xl neon-text">
                        <span class="text-red-600 dark:text-red-500">Pitcher</span>
                        <span class="text-blue-600 dark:text-blue-500">Perfect</span>
                    </div>
                </div>
                <div class="flex items-center space-x-8">
                    <a href="/"
                        class="text-gray-800 dark:text-white hover:text-red-600 dark:hover:text-red-500 transition-colors">Home</a>
                    <a href="/Chat_dashboard"
                        class="text-gray-800 dark:text-white hover:text-red-600 dark:hover:text-red-500 transition-colors">Fan
                        Link</a>
                    <a href="/yourteam"
                        class="text-gray-800 dark:text-white hover:text-red-600 dark:hover:text-red-500 transition-colors">Your
                        Team</a>
                    <a href="/profile"
                        class="text-gray-800 dark:text-white hover:text-red-600 dark:hover:text-red-500 transition-colors">Profile</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Settings Icons -->
    <div class="fixed top-4 right-4 z-50 flex items-center space-x-4">
        <button id="theme-toggle"
            class="p-3 rounded-full bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors">
            üåì
        </button>
        <div class="relative">
            <button id="settings-toggle"
                class="p-3 rounded-full bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors">
                ‚öôÔ∏è
            </button>
            <div id="settings-dropdown"
                class="hidden absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700">
                <div class="py-1">
                    <a href="?lang=en"
                        class="block px-4 py-2 hover:bg-red-100 dark:hover:bg-red-900 transition-colors">English</a>
                    <a href="?lang=ja"
                        class="block px-4 py-2 hover:bg-red-100 dark:hover:bg-red-900 transition-colors">Japanese</a>
                    <a href="?lang=es"
                        class="block px-4 py-2 hover:bg-red-100 dark:hover:bg-red-900 transition-colors">Spanish</a>
                    <a href="?lang=de"
                        class="block px-4 py-2 hover:bg-red-100 dark:hover:bg-red-900 transition-colors">German</a>
                    <a href="?lang=ko"
                        class="block px-4 py-2 hover:bg-red-100 dark:hover:bg-red-900 transition-colors">Korean</a>
                    <a href="?lang=fr"
                        class="block px-4 py-2 hover:bg-red-100 dark:hover:bg-red-900 transition-colors">French</a>
                    <a href="?lang=hi"
                        class="block px-4 py-2 hover:bg-red-100 dark:hover:bg-red-900 transition-colors">Hindi</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container mx-auto px-4 py-8">
        <div class="text-center mb-12">
            <h1 class="baseball-font text-6xl mb-3 neon-text">
                <span class="text-red-600 dark:text-red-500">Pitcher</span>
                <span class="text-blue-600 dark:text-blue-500">Perfect</span>
            </h1>
            <p class="text-gray-600 dark:text-gray-400 italic text-xl">Your Perfect Pitch for All MLB Game Needs</p>
        </div>

        <!-- Upcoming Games Section -->
        <div class="mb-12">
            <h2 class="text-3xl font-bold mb-6 text-red-600 dark:text-red-500 neon-text"></h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                {% for game in upcoming_games %}
                <div
                    class="bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 border-2 border-red-400 dark:border-red-600 hover:border-blue-600 dark:hover:border-blue-500 transition-all transform hover:scale-105">
                    <div class="flex justify-between items-center mb-4">
                        <div class="text-xl font-bold text-gray-800 dark:text-white">{{ game.homeTeam }}</div>
                        <div class="text-lg text-red-600 dark:text-red-500 neon-text">vs</div>
                        <div class="text-xl font-bold text-gray-800 dark:text-white">{{ game.awayTeam }}</div>
                    </div>
                    <div class="text-gray-600 dark:text-gray-400 mb-2">
                        <i class="fas fa-map-marker-alt"></i> {{ game.venue }}
                    </div>
                    <div class="text-gray-600 dark:text-gray-400">
                        {{ game.gameDate|replace("T", " ")|replace("Z", "") }}
                    </div>
                    <div
                        class="mt-3 inline-block bg-red-500 dark:bg-red-600 text-white px-3 py-1 rounded-full text-sm neon-box">
                       
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>

        <!-- Stats Graph -->
        <div class="max-w-5xl mx-auto mb-12 bg-white dark:bg-gray-800 p-8 rounded-lg shadow-xl">
            <h2 class="text-3xl font-bold mb-6 text-blue-600 dark:text-blue-500 neon-text">Performance Statistics</h2>
            <div class="h-80 bg-gray-50 dark:bg-gray-900 relative rounded-lg overflow-hidden">
                <div class="absolute inset-0 flex items-end justify-between px-4 pb-4">
                    {% for i in range(6) %}
                    <div
                        class="w-2 bg-gradient-to-t from-red-600 to-blue-600 dark:from-red-500 dark:to-blue-500 rounded-t-lg transition-all duration-500 neon-box">
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>

        <!-- Enhanced News Section -->
        <div class="fixed bottom-4 left-4 w-96 max-w-[90vw] z-40">
            <h2 class="text-2xl font-bold mb-3 text-blue-600 dark:text-blue-500 neon-text">
            </h2>
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl p-4 news-scroll">
                {% for article in news %}
                <a href="{{ article.link }}"
                    class="block mb-4 last:mb-0 hover:transform hover:scale-102 transition-all">
                    <div class="p-4 rounded-lg news-card hover:bg-red-50 dark:hover:bg-red-900/30 transition-colors">
                        <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-2">{{ article.title }}</h3>
                        <p class="text-gray-600 dark:text-gray-400 text-sm">{{ article.summary }}</p>
                        <div class="mt-2 flex justify-between items-center">
                            <span class="text-red-600 dark:text-red-500 text-sm">{{ article.date }}</span>
                            <span class="text-blue-600 dark:text-blue-500 text-sm">Read more ‚Üí</span>
                        </div>
                    </div>
                </a>
                {% endfor %}
            </div>
        </div>
    </div>

    <!-- Chatbot -->
    <div class="fixed bottom-4 right-4 z-50">
        <button id="chatbot-trigger"
            class="w-14 h-14 bg-red-600 dark:bg-red-500 text-white rounded-full flex items-center justify-center text-2xl shadow-lg hover:bg-blue-600 dark:hover:bg-blue-500 transition-colors neon-box">
            ‚öæ
        </button>
        <div id="chatbot-container"
            class="hidden absolute bottom-16 right-0 w-96 max-w-[calc(100vw-2rem)] bg-white dark:bg-gray-800 rounded-lg shadow-xl">
            <div class="p-4 bg-red-600 dark:bg-red-500 text-white rounded-t-lg flex justify-between items-center">
                <h5 class="font-bold">Pitcher Perfect Chatbot ‚öæ</h5>
                <button id="close-chatbot" class="hover:text-gray-200">‚úñ</button>
            </div>
            <div id="chatbot-messages" class="h-96 p-4 overflow-y-auto">
                <!-- Messages will appear here -->
            </div>
            <div class="p-4 border-t border-gray-200 dark:border-gray-700 flex">
                <input type="text" id="chatbot-input"
                    class="flex-1 px-4 py-2 rounded-l-lg border-2 border-r-0 border-gray-200 dark:border-gray-700 dark:bg-gray-900 dark:text-white focus:outline-none focus:border-red-500 dark:focus:border-red-400"
                    placeholder="Type your message here..." />
                <button id="send-message"
                    class="px-6 py-2 bg-red-600 dark:bg-red-500 text-white rounded-r-lg hover:bg-blue-600 dark:hover:bg-blue-500 transition-colors">
                    Send
                </button>
            </div>
        </div>
    </div>

    <script>
        // Theme and News UI Elements
        const themeToggle = document.getElementById('theme-toggle');
        const newsSection = document.querySelector('.fixed.bottom-4.left-4');
        const newsIcon = document.createElement('button');

        // Set up the news toggle icon
        newsIcon.innerHTML = 'üì∞';
        newsIcon.className = 'w-14 h-14 bg-red-600 dark:bg-red-500 text-white rounded-full flex items-center justify-center text-2xl shadow-lg hover:bg-blue-600 dark:hover:bg-blue-500 transition-colors neon-box';
        newsSection.style.display = 'none'; // Initially hide news section

        // Insert news toggle button before the news section
        newsSection.parentNode.insertBefore(newsIcon, newsSection);

        // Theme Toggle Functionality
        function updateThemeIcon() {
            const isDark = document.documentElement.classList.contains('dark');
            themeToggle.innerHTML = isDark ? '‚òÄÔ∏è' : 'üåô';
        }

        // Initialize theme based on system preference
        if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        } else {
            document.documentElement.classList.remove('dark');
        }
        updateThemeIcon();

        // Theme toggle event listener
        themeToggle.addEventListener('click', () => {
            document.documentElement.classList.toggle('dark');
            updateThemeIcon();

            // Save theme preference
            localStorage.theme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
        });

        // News toggle functionality
        newsIcon.addEventListener('click', () => {
            const currentDisplay = newsSection.style.display;
            newsSection.style.display = currentDisplay === 'none' ? 'block' : 'none';

            // Add a subtle animation class
            if (newsSection.style.display === 'block') {
                newsSection.classList.add('animate-fade-in');
                setTimeout(() => newsSection.classList.remove('animate-fade-in'), 300);
            }
        });

        // Add animation keyframes to existing styles
        const style = document.createElement('style');
        style.textContent = `
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }
    .animate-fade-in {
        animation: fadeIn 0.3s ease-out;
    }
`;
        document.head.appendChild(style);

        // Listen for system theme changes
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
            if (e.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
            updateThemeIcon();
        });

        // Settings Dropdown
        const settingsToggle = document.getElementById('settings-toggle');
        const settingsDropdown = document.getElementById('settings-dropdown');

        settingsToggle.addEventListener('click', (e) => {
            e.stopPropagation();
            settingsDropdown.classList.toggle('hidden');
        });

        document.addEventListener('click', (e) => {
            if (!settingsDropdown.contains(e.target)) {
                settingsDropdown.classList.add('hidden');
            }
        });
        // JavaScript for Chatbot Functionality
        const chatbotTrigger = document.getElementById("chatbot-trigger");
        const chatbotContainer = document.getElementById("chatbot-container");
        const chatbotMessages = document.getElementById("chatbot-messages");
        const chatbotInput = document.getElementById("chatbot-input");
        const sendMessageBtn = document.getElementById("send-message");
        const closeChatbotBtn = document.getElementById("close-chatbot");

        // Toggle chatbot visibility
        chatbotTrigger.addEventListener("click", () => {
            chatbotContainer.style.display =
                chatbotContainer.style.display === "none" || chatbotContainer.style.display === ""
                    ? "block"
                    : "none";
        });

        // Close chatbot
        closeChatbotBtn.addEventListener("click", () => {
            chatbotContainer.style.display = "none";
        });

        // Handle sending messages
        async function handleSendMessage() {
            const userMessage = chatbotInput.value.trim();

            if (!userMessage) return;

            // Create and append user message
            const userMessageElement = document.createElement("div");
            userMessageElement.innerText = `You: ${userMessage}`;
            userMessageElement.style.color = "blue";
            chatbotMessages.appendChild(userMessageElement);

            // Auto scroll to bottom
            chatbotMessages.scrollTop = chatbotMessages.scrollHeight;

            // Clear input
            chatbotInput.value = "";

            try {
                // Send message to backend
                const response = await fetch("/chatbot", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify({ message: userMessage }),
                });

                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }

                const data = await response.json();

                // Create and append bot response
                const botMessageElement = document.createElement("div");
                botMessageElement.innerText = `PitcherPerfect: ${data.response}`;
                botMessageElement.style.color = "red";
                chatbotMessages.appendChild(botMessageElement);

            } catch (error) {
                // Handle error gracefully
                const errorMessage = document.createElement("div");
                errorMessage.innerText = "Sorry, I'm having trouble connecting right now. Please try again later.";
                errorMessage.style.color = "red";
                chatbotMessages.appendChild(errorMessage);
                console.error('Error:', error);
            }

            // Auto scroll to bottom
            chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
        }

        // Event listeners for sending messages
        sendMessageBtn.addEventListener("click", handleSendMessage);

        // Allow sending messages with Enter key
        chatbotInput.addEventListener("keypress", (event) => {
            if (event.key === "Enter") {
                handleSendMessage();
            }
        });
    </script>
</body>

</html>